{"version":3,"sources":["index/contact.js"],"names":["$","i18n","properties","name","path","getLanguage","mode","language","callback","setRoleDropdownList","setTypeDropdownList","roleLength","typeLength","roleList","i","prop","html","onRoleDropdownItemClick","typeList","onTypeDropdownItemClick","click","e","console","log","target","text","val","hasValid","valid","dropdownIconAnimation","on","this","children","addClass","removeClass","formValid","validate","rules","required","role","email","subject","message","onSubmit","ajax","title","occupationField","content","res","success","resetForm","showTipsModal"],"mappings":"aACAA,EAAE,WADFA,EAAAC,KAAAC,WAAA,CACEC,KAAA,WACEF,KAAKC,SACLC,KAAI,MACJC,SAAKC,cACLC,SAAK,WACLC,sBACAC,sBACEC,wBACAC,iBAQN,IAAIC,WAAa,GAAbA,WAAa,EACbC,UAAU,EAId,SAASH,sBAEP,IADA,IAAII,EAAW,GACPC,EAAI,EAAGA,GAAKH,WAAYG,GAAK,EAArCD,GAAA,oDAAwCb,EAAAC,KAAAc,KAAA,oBAAAD,GAAA,QAEvCd,EAAA,wCAAAgB,KAAAH,GAEDI,0BAIF,SAASP,sBAAT,IACE,IAAIQ,EAAW,GADRR,EAAAA,EAAAA,GAAAA,WAAsBI,GAAA,EAC7BI,GAAY,oDAAZlB,EAAAC,KAAAc,KAAA,oBAAAD,GAAA,QACAd,EAAA,wCAAwCgB,KAAAE,GACtCA,0BAGFC,SAAAA,0BAGFnB,EAAA,wCAAAoB,MAAA,SAAAC,GAGIC,QAAQC,IAAIvB,EAAEqB,EAAEG,QAAQC,QACxBzB,EAAE,SAAS0B,IAAI1B,EAAEqB,EAAEG,QAAQC,QAH/BE,UACI3B,EAAA,gBAAA4B,UAKC,SAAAT,0BACFnB,EAND,wCAAAoB,MAAA,SAAAC,GASFrB,EAAA,SAAA0B,IAAA1B,EAAAqB,EAAAG,QAAAC,QAIOE,UACD3B,EAAE,gBAAgB4B,UAAlB5B,SAAE6B,wBACH7B,EAAA,gDAAA8B,GAAA,mBAAA,WAJH9B,EAAA+B,MAAAC,SAAA,yBAAAC,SAAA,cAaAjC,EAAE,gDAAgD8B,GAAG,mBAAoB,WACvE9B,EAAE+B,MAAMC,SAAS,yBAAyBE,YAAY,cADxDlC,SAAEmC,YACAnC,EAAAA,gBAAAoC,SAAiB,CADnBC,MAAA,CAKFlC,KAAA,CAKQmC,UAAU,GAJlBC,KAASJ,CACLG,UAAD,GAEGnC,MAAM,CACJmC,UAAU,EAFPE,OAAA,GAKHF,QAAAA,CALGA,UAAA,GAQHA,KAAAA,CACAE,UAAO,GAETC,QAAS,CACPH,UAAU,IAGVA,SAAAA,CADInC,KAdD,CAiBLuC,SAAS1C,EAAAC,KAAAc,KAAA,yBAAAwB,KAAA,CAlBcD,SAAAtC,EAAAC,KAAAc,KAAA,yBAuBvBZ,MAAM,CACJmC,SAAUtC,EAAEC,KAAKc,KAAK,yBAFhByB,MAAAxC,EAAAC,KAAAc,KAAA,4BAKNuB,QAAAA,CALMA,SAAAtC,EAAAC,KAAAc,KAAA,4BAQNuB,KAAAA,CACAE,SAASvC,EAAAA,KAAKc,KAAK,yBAErB0B,QAAS,CACPH,SAAUtC,EAAEC,KAAKc,KAAK,+BAKf,SAAA4B,WAjBDhB,UAAA,EAtBZ3B,EAAA,gBAAA4B,SA8CFgB,KAAA,CAKMC,MAAS7C,EAAE,YAAY0B,MACvBoB,gBAAmB9C,EAAE,SAAS0B,MALpCqB,QAAA/C,EAAA,YAAoB0B,MAClBC,KAAW3B,EAAA,SAAX0B,MAOIvB,KAAQH,EAAE,SAAS0B,MANpB1B,MAAEA,EAAA,UAAgB4B,MACnBgB,MAAK5C,EAAA,UAAA0B,OACH,WAAW,OAAD,SADPsB,GAEHA,EAAAC,UACAC,YACAC,cAAUnD,EAAFC,KAAAc,KAJL,sBAAAf,EAAAC,KAAAc,KAAA,+BAAAf,EAAAC,KAAAc,KAAA,sBAWDoC,SAAAA,YACDnD,EAAA,SAAA0B,IAAA,IACF1B,EAAA,SAbD0B,IAAA,IAcD1B,EAAA,UAAA0B,IAAA,IAGH1B,EAAA,UAAA0B,IAAA,IAME1B,EAAE,YAAY0B,IAAI,IAClB1B,EAAE,SAAS0B,IAAI,IANjB1B,EAAA,YAASkD,IAAT","file":"contact.js","sourcesContent":["// 初始化\r\n$(function () {\r\n  $.i18n.properties({\r\n    name:'messages', \r\n    path:'/i18n/', \r\n    mode:'map',\r\n    language: getLanguage(),\r\n    callback: function() {\r\n      setRoleDropdownList()\r\n      setTypeDropdownList()\r\n      dropdownIconAnimation()\r\n      formValid()\r\n    }\r\n  });\r\n})\r\n\r\n// 变量\r\nvar roleLength = 11\r\nvar typeLength = 4\r\nvar hasValid = false\r\n\r\n// 设置职业领域下拉列表\r\nfunction setRoleDropdownList() {\r\n  var roleList = ''\r\n  for(var i = 1; i <= roleLength; i += 1) {\r\n    roleList += '<li class=\"dropdown-item contact__dropdown-item\">' + $.i18n.prop('contact.role.role' + i) + '</li>'\r\n  }\r\n  $('.contact__select-role .dropdown-menu').html(roleList)\r\n  onRoleDropdownItemClick()\r\n}\r\n\r\n// 设置信息类型下拉列表\r\nfunction setTypeDropdownList() {\r\n  var typeList = ''\r\n  for(var i = 1; i <= typeLength; i += 1) {\r\n    typeList += '<li class=\"dropdown-item contact__dropdown-item\">' + $.i18n.prop('contact.type.type' + i) + '</li>'\r\n  }\r\n  $('.contact__select-type .dropdown-menu').html(typeList)\r\n  onTypeDropdownItemClick()\r\n}\r\n\r\n// 监听职业领域选中\r\nfunction onRoleDropdownItemClick() {\r\n  $('.contact__select-role .dropdown-item').click(function(e) {\r\n    console.log($(e.target).text())\r\n    $(\"#role\").val($(e.target).text())\r\n    if(hasValid) {\r\n      $(\"#contactForm\").valid()\r\n    }\r\n  })\r\n}\r\n\r\n// 监听信息类型选中\r\nfunction onTypeDropdownItemClick() {\r\n  $('.contact__select-type .dropdown-item').click(function(e) {\r\n    $(\"#type\").val($(e.target).text())\r\n    if(hasValid) {\r\n      $(\"#contactForm\").valid()\r\n    }\r\n  })\r\n}\r\n\r\n// 下拉列表图标动画\r\nfunction dropdownIconAnimation() {\r\n  $('.contact__select-role, .contact__select-type').on('show.bs.dropdown', function () {\r\n    $(this).children('.contact__select-icon').addClass('reversed')\r\n  })\r\n  $('.contact__select-role, .contact__select-type').on('hide.bs.dropdown', function () {\r\n    $(this).children('.contact__select-icon').removeClass('reversed')\r\n  })\r\n}\r\n\r\n// 表单验证规则\r\nfunction formValid() {\r\n  $(\"#contactForm\").validate({\r\n    rules: {\r\n      name: {\r\n        required: true,\r\n      },\r\n      role: {\r\n        required: true,\r\n      },\r\n      email: {\r\n        required: true,\r\n        email: true\r\n      },\r\n      subject: {\r\n        required: true,\r\n      },\r\n      type: {\r\n        required: true,\r\n      },\r\n      message: {\r\n        required: true,\r\n      },\r\n    },\r\n    messages: {\r\n      name: {\r\n        required: $.i18n.prop('error.form.nameEmpty'),\r\n      },\r\n      role: {\r\n        required: $.i18n.prop('error.form.roleEmpty'),\r\n      },\r\n      email: {\r\n        required: $.i18n.prop('error.form.emailEmpty'),\r\n        email: $.i18n.prop('error.form.emailInvalid')\r\n      },\r\n      subject: {\r\n        required: $.i18n.prop('error.form.subjectEmpty'),\r\n      },\r\n      type: {\r\n        required: $.i18n.prop('error.form.typeEmpty'),\r\n      },\r\n      message: {\r\n        required: $.i18n.prop('error.form.messageEmpty'),\r\n      },\r\n    }\r\n  })\r\n}\r\n\r\n// 提交表单\r\nfunction onSubmit() {\r\n  hasValid = true\r\n  if($(\"#contactForm\").valid()) {\r\n    ajax({\r\n      \"title\": $(\"#subject\").val(),\r\n      \"occupationField\": $(\"#role\").val(),\r\n      \"content\": $(\"#message\").val(),\r\n      \"type\": $(\"#type\").val(),\r\n      \"name\": $(\"#name\").val(),\r\n      \"email\": $(\"#email\").val(),\r\n      \"phone\": $(\"#phone\").val(),\r\n    }, '/contact', 'POST', function(res) {\r\n      if(res.success) {\r\n        resetForm()\r\n        showTipsModal($.i18n.prop('modal.title.thanks'), $.i18n.prop('modal.title.contactFeedback'), $.i18n.prop('modal.title.ok'))\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\n// 重置表单\r\nfunction resetForm() {\r\n  $(\"#name\").val('');\r\n  $(\"#role\").val('');\r\n  $(\"#email\").val('');\r\n  $(\"#phone\").val('');\r\n  $(\"#subject\").val('');\r\n  $(\"#type\").val('');\r\n  $(\"#message\").val('');\r\n}"]}